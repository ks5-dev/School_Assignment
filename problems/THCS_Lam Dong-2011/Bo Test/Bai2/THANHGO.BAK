const
   tfi                  =       'THANHGO.IN1';
   tfo                  =       'THANHGO.OU1';
   maxN                 =       50;
   maxL                 =       100;
var
   fi, fo               :       text;
   N                    :       integer;
   L                    :       array[1..maxN] of integer;
   name                 :       array[1..maxN] of integer;
   T                    :       integer;
   ok                   :       boolean;
   x                    :       array[1..maxN] of integer;
   Sp                   :       integer;

   dd                   :       array[0..maxN*maxL] of integer;

procedure SapXep;
var i,j,Tg: integer;
begin
   for i:=1 to N do name[i]:=i;
   for i:=1 to N-1 do
      for j:=i+1 to N do
         if L[i]<L[j] then
            begin
               Tg:=name[i]; name[i]:=name[j]; name[j]:=Tg;
               Tg:=L[i]; L[i]:=L[j]; L[j]:=Tg;
            end;
end;

procedure Docdl;
var i: integer;
begin
   assign(fi,tfi); reset(fi);
   read(fi,N);
   for i:=1 to N do read(fi,L[i]);
   close(fi);
end;

procedure LapTong(u: integer);
var max,i,j: integer;
begin
   fillchar(dd,sizeof(dd),0);
   dd[0]:=-1;
   max:=0;
   for i:=1 to N do
      if x[i]=0 then
         begin
            j:=max;
            while j>=0 do
               begin
                  if (j+L[i]<=u) and (dd[j]<>0) and (dd[j+L[i]]=0) then
                     begin
                        dd[j+L[i]]:=i;
                        if max<j+L[i] then max:=j+L[i];
                        if max=u then exit;
                     end;
                  dec(j);
               end;
         end;
end;

procedure TimPhan(u,v: integer);
var i,j: integer;
begin
   i:=u;
   while i>0 do
      begin
         j:=dd[i];
         x[j]:=v;
         i:=i-L[j];
      end;
end;

procedure Chia(u: integer);
var i: integer;
begin
   ok:=false;
   for i:=1 to N do x[i]:=0;
   Sp:=T div u;
   for i:=1 to Sp do
      begin
         LapTong(u);
         if dd[u]=0 then exit;
         TimPhan(u,i);
      end;
   ok:=true;
end;

procedure Tim;
var LL,i: integer;
begin
   (* Tinh tong, tim min L[i] *)
   T:=0;
   for i:=1 to N do T:=T+L[i];
   LL:=L[1];
   for i:=2 to N do
      if L[i]<LL then LL:=L[i];
   (* Duyet *)
   for i:=LL to T do
      if T mod i=0 then
         begin
            Chia(i);
            if ok then exit;
         end;
end;

procedure Inkq;
var i,j: integer;
begin
   assign(fo,tfo); rewrite(fo);
   if not ok then writeln(fo,-1) else
      begin
         writeln(fo,T div Sp);
         for i:=1 to Sp do
            begin
               for j:=1 to N do
                  if x[j]=i then write(fo,j,' ');
               writeln(fo);
            end;
      end;
   close(fo);
end;

BEGIN
   Docdl;
   SapXep;
   Tim;
   Inkq;
END.